<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.PaymentDAO">
  	<!-- DB의 컬럼명과 VO의 변수명 맵핑 -->
  	<resultMap type="paymentVO" id="paymentMap">
  		<result column="member_id" property="memberId" />
  		<result column="pass_no" property="passNo" />
  		<result column="pay_method" property="payMethod" />
  		<result column="pay_date" property="payDate" />
  	</resultMap>
  	
  	<sql id="selectPayment">
  		select no, member_id, pass_no, amount, pay_method, to_char(pay_date, 'yyyy-mm-dd') pay_date
  		  from payment
  	</sql>
  	
  	<!-- 게시글조회(제목, 작성자) -->
  	<select id="selectWhere" parameterType="boardVO" resultMap="boardMap">
  		<include refid="selectBoard" />
  		<where>
  			<if test="title != null">
  				title=#{title}
  			</if>
  			<if test="writer != null">
  				and writer=#{writer}
  			</if>
  		</where>
  	</select>
  	
  	<!-- 게시글 번호로 조회 -->
  	<select id="selectByNo" parameterType="int" resultMap="boardMap">
  		select no, title, writer, content, view_cnt, to_char(reg_date, 'yyyy-mm-dd') reg_date
  		  from t_board
  		 where no = #{no}
  	</select>
  	
  	<select id="selectByNo2" parameterType="boardVO"  resultMap="boardMap">
  		select no, title, writer, content, view_cnt, to_char(reg_date, 'yyyy-mm-dd') reg_date
  		  from t_board
  		 where no = #{no}
  	</select>
  	
  	<select id="selectByNo3" parameterType="int" resultType="map" >
  		select no, title, writer, content, view_cnt, to_char(reg_date, 'yyyy-mm-dd') reg_date
  		  from t_board
  		 where no = #{no}
  	</select>
  	
  	<!-- 전체게시글 조회 -->
  	<select id="selectAll" resultType="boardVO">
  		select no, title, writer, to_char(reg_date, 'yyyy-mm-dd') regDate
  		  from t_board
  		 order by no desc  	
  	</select>
  	<select id="selectAll2" resultMap="boardMap">
  		select no, title, writer, to_char(reg_date, 'yyyy-mm-dd') reg_date
  		  from t_board
  		 order by no desc  	
  	</select>
  	
  	<!-- 결제 내역 삽입 -->
  	<insert id="insert" parameterType="paymentVO">
  		INSERT INTO PAYMENT (NO, MEMBER_ID, PASS_NO, AMOUNT, PAY_METHOD)
		VALUES (SEQ_PAYMENT_NO.nextval, #{memberId}, #{passNo}, #{amount}, #{payMethod})
  	</insert>
</mapper>